/*
 * adc.c
 *
 *  Created on: Aug 10, 2025
 *      Author: wh310
 */


#include "adc.h"


extern ADC_HandleTypeDef hadc1;

uint16_t adc_data[3];

bool adcInit(void)
{
  HAL_ADCEx_Calibration_Start(&hadc1);
  HAL_ADC_Start_DMA(&hadc1,(uint32_t *)&adc_data,3);

  return true;
}


uint16_t adcRead(uint8_t ch)
{
  uint16_t ret = 0;

  switch(ch)
  {
    case _DEF_CH1:

      ret = adc_data[ch];
      break;
  }


  return ret;

}
uint32_t adcReadVoltage(uint8_t ch)
{

  uint32_t ret;
  uint32_t adc_data;
  adc_data = adcRead(ch);


  ret = (330 *adc_data)/ 4096;

  return ret;
}

//void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef *hadc) //adc 컨버젼이 완료 되었을때 호출되는 함수
//{
//  static uint32_t adc_cnt=0;
//  static uint32_t pre_time;
//
//  adc_cnt++;
//
//  if(millis()-pre_time >=1000)
//  {
//    pre_time = millis();
//
//    adc_time = adc_cnt;
//    adc_cnt = 0;
//  }
//
//}
